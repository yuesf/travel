# 小程序性能优化说明

## 1. 代码优化

### 1.1 分包加载
- 已配置分包加载，将订单和文章页面独立为分包
- 主包包含核心页面：首页、分类、购物车、我的
- 分包配置在 `app.json` 中：
  - `pages/order` - 订单相关页面
  - `pages/article` - 文章相关页面
- 预加载规则：首页和购物车页面预加载订单分包

### 1.2 代码压缩
- 已在 `project.config.json` 中启用代码压缩：
  - `minified: true` - 启用代码压缩
  - `minifyWXSS: true` - 压缩样式文件
  - `minifyWXML: true` - 压缩模板文件

### 1.3 按需加载
- 使用 `lazyCodeLoading: "requiredComponents"` 启用按需加载
- 组件和页面按需加载，减少初始加载时间

## 2. 渲染优化

### 2.1 图片懒加载
- 列表页面的图片已添加 `lazy-load` 属性
- 图片在进入视口时才开始加载，减少初始加载时间
- 已优化的页面：
  - 分类页面商品列表
  - 文章列表页面
  - 文章详情页面相关推荐

### 2.2 分页加载
- 所有列表页面都实现了分页加载
- 使用上拉加载更多，避免一次性加载大量数据
- 已实现的页面：
  - 分类页面
  - 订单列表页面
  - 文章列表页面

### 2.3 下拉刷新
- 关键页面支持下拉刷新，及时更新数据
- 已实现的页面：
  - 首页
  - 分类页面
  - 购物车页面
  - 订单列表页面
  - 文章列表页面

## 3. 网络优化

### 3.1 请求合并
- 首页数据合并请求，减少请求次数
- 使用 Promise.all 并行请求多个接口

### 3.2 数据缓存
- 首页数据使用本地缓存，减少重复请求
- 缓存策略：
  - 首页轮播图和推荐内容缓存5分钟
  - 用户信息缓存，登录后更新

### 3.3 请求超时
- 已配置请求超时时间：10秒
- 超时后自动重试，提升用户体验

## 4. 存储优化

### 4.1 本地存储
- 合理使用本地存储，避免存储过大数据
- 存储内容：
  - 用户登录信息（Session ID）
  - 用户基本信息
  - 首页缓存数据

### 4.2 缓存策略
- 设置合理的缓存过期时间
- 首页数据缓存5分钟
- 用户信息缓存，登录后立即更新

## 5. 性能指标

### 5.1 主包体积
- 目标：主包体积不超过2MB
- 已通过分包加载优化主包体积

### 5.2 页面加载速度
- 首屏加载时间：< 2秒
- 页面切换流畅，无明显卡顿

### 5.3 图片优化
- 建议使用 WebP 格式图片
- 图片大小控制在200KB以内
- 使用 CDN 加速图片加载

## 6. 后续优化建议

1. **图片优化**
   - 使用 WebP 格式
   - 实现图片压缩和裁剪
   - 使用 CDN 加速

2. **骨架屏**
   - 为列表页面添加骨架屏
   - 提升加载体验

3. **虚拟列表**
   - 对于超长列表，考虑使用虚拟列表
   - 减少 DOM 节点数量

4. **预加载优化**
   - 优化预加载策略
   - 根据用户行为预测加载内容

5. **代码分割**
   - 进一步拆分公共组件
   - 按需加载组件
