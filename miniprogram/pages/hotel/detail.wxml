<!-- é…’åº—è¯¦æƒ…é¡µï¼ˆç‹¬ç«‹ï¼‰ -->
<view class="page-container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-container">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- å†…å®¹åŒºåŸŸ -->
  <view wx:elif="{{detail}}" class="content-container">
    <!-- å›¾ç‰‡/è§†é¢‘è½®æ’­åŒºåŸŸ -->
    <view class="swiper-container">
      <swiper
        class="swiper"
        indicator-dots="{{mediaList.length > 1}}"
        indicator-color="rgba(255, 255, 255, 0.5)"
        indicator-active-color="#ffffff"
        autoplay="{{mediaList.length > 1}}"
        interval="{{3000}}"
        duration="{{500}}"
        circular="{{true}}"
        bindchange="onSwiperChange"
      >
        <swiper-item wx:for="{{mediaList}}" wx:key="index">
          <!-- å›¾ç‰‡ -->
          <image
            wx:if="{{item.type === 'image'}}"
            class="swiper-image"
            src="{{item.url}}"
            mode="aspectFill"
            data-index="{{index}}"
            bindtap="onImageTap"
          />
          <!-- è§†é¢‘ -->
          <video
            wx:elif="{{item.type === 'video'}}"
            class="swiper-video"
            src="{{item.url}}"
            poster="{{item.poster}}"
            controls="{{true}}"
            show-center-play-btn="{{true}}"
            enable-play-gesture="{{true}}"
            bindplay="onVideoPlay"
            bindfullscreenchange="onVideoFullscreenChange"
          />
        </swiper-item>
      </swiper>
      <!-- è½®æ’­æŒ‡ç¤ºå™¨ -->
      <view wx:if="{{mediaList.length > 1}}" class="swiper-indicator">
        <text class="swiper-indicator-text">{{currentSwiperIndex + 1}}/{{mediaList.length}}</text>
      </view>
    </view>

    <!-- åŸºæœ¬ä¿¡æ¯åŒºåŸŸ -->
    <view class="info-section">
      <view class="info-header">
        <text class="info-name">{{detail.name}}</text>
        <view class="info-price-row">
          <text class="info-price">Â¥{{detail.price}}</text>
          <text wx:if="{{detail.originalPrice}}" class="info-original-price">Â¥{{detail.originalPrice}}</text>
        </view>
      </view>

      <!-- è¯„åˆ†ã€ä½ç½®ã€æ˜Ÿçº§ -->
      <view class="info-meta">
        <view wx:if="{{detail.rating}}" class="info-rating">
          <text class="info-rating-text">è¯„åˆ†ï¼š{{detail.rating}}</text>
          <text class="info-rating-star">â˜…</text>
        </view>
        <view wx:if="{{detail.starLevel}}" class="info-hotel">
          <text class="info-hotel-text">æ˜Ÿçº§ï¼š{{detail.starLevel}}æ˜Ÿ</text>
        </view>
        <view wx:if="{{detail.address}}" class="info-location">
          <text class="info-location-icon">ğŸ“</text>
          <text class="info-location-text">{{detail.address}}</text>
        </view>
      </view>
    </view>

    <!-- æˆ¿å‹åˆ—è¡¨ -->
    <view wx:if="{{detail.rooms && detail.rooms.length}}" class="detail-section">
      <view class="detail-tab-content">
        <view class="detail-rooms">
          <view class="detail-rooms-title">æˆ¿å‹é€‰æ‹©</view>
          <view class="detail-rooms-list">
            <view
              wx:for="{{detail.rooms}}"
              wx:key="id"
              class="room-item"
              data-room="{{item}}"
              bindtap="onSelectRoom"
            >
              <view class="room-info">
                <text class="room-name">{{item.name}}</text>
                <text class="room-desc">{{item.description}}</text>
                <view class="room-features">
                  <text wx:for="{{item.features}}" wx:key="index" class="room-feature">{{item}}</text>
                </view>
              </view>
              <view class="room-price">
                <text class="room-price-text">Â¥{{item.price}}</text>
                <text class="room-price-unit">/æ™š</text>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- é…’åº—è¯¦æƒ…æè¿° -->
    <view class="detail-section">
      <view class="tabs-container">
        <view
          wx:for="{{['è¯¦æƒ…', 'è¯„ä»·', 'é¡»çŸ¥']}}"
          wx:key="index"
          class="tab-item {{activeTab === index ? 'active' : ''}}"
          data-index="{{index}}"
          bindtap="onTabChange"
        >
          <text class="tab-text">{{item}}</text>
        </view>
      </view>

      <view class="detail-content">
        <!-- è¯¦æƒ… -->
        <view wx:if="{{activeTab === 0}}" class="detail-tab-content">
          <view wx:if="{{detail.description}}" class="detail-description">
            <rich-text nodes="{{detail.description}}"></rich-text>
          </view>
        </view>

        <!-- è¯„ä»· -->
        <view wx:if="{{activeTab === 1}}" class="detail-tab-content">
          <view class="empty-content">
            <text class="empty-text">æš‚æ— è¯„ä»·</text>
          </view>
        </view>

        <!-- é¡»çŸ¥ -->
        <view wx:if="{{activeTab === 2}}" class="detail-tab-content">
          <view wx:if="{{detail.notice}}" class="detail-notice">
            <rich-text nodes="{{detail.notice}}"></rich-text>
          </view>
          <view wx:else class="empty-content">
            <text class="empty-text">æš‚æ— é¡»çŸ¥</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view wx:if="{{!loading && !detail}}" class="empty-container">
    <text class="empty-text">æš‚æ— é…’åº—ä¿¡æ¯</text>
  </view>

  <!-- æˆ¿å‹é€‰æ‹©å¼¹çª— -->
  <view wx:if="{{showRoomModal}}" class="room-modal-mask" bindtap="onCloseRoomModal" catchtouchmove="onPreventMove">
    <view class="room-modal" catchtap="true">
      <view class="room-modal-header">
        <text class="room-modal-title">ç¡®è®¤é¢„è®¢</text>
        <text class="room-modal-close" bindtap="onCloseRoomModal">âœ•</text>
      </view>

      <scroll-view class="room-modal-content" scroll-y="true">
        <!-- æˆ¿å‹ä¿¡æ¯ -->
        <view wx:if="{{selectedRoom}}" class="room-modal-item-info">
          <text class="room-modal-item-name">{{selectedRoom.name}}</text>
          <text class="room-modal-item-desc">{{selectedRoom.description}}</text>
        </view>

        <!-- æ—¥æœŸé€‰æ‹© -->
        <view class="room-modal-dates">
          <view class="date-item">
            <text class="date-label">å…¥ä½æ—¥æœŸ</text>
            <picker mode="date" value="{{checkInDate}}" start="{{minDate}}" bindchange="onCheckInDateChange">
              <view class="date-picker">
                <text class="date-text">{{checkInDate || 'è¯·é€‰æ‹©'}}</text>
                <text class="date-arrow">â€º</text>
              </view>
            </picker>
          </view>
          <view class="date-item">
            <text class="date-label">é€€æˆ¿æ—¥æœŸ</text>
            <picker mode="date" value="{{checkOutDate}}" start="{{checkInDate || minDate}}" bindchange="onCheckOutDateChange">
              <view class="date-picker">
                <text class="date-text">{{checkOutDate || 'è¯·é€‰æ‹©'}}</text>
                <text class="date-arrow">â€º</text>
              </view>
            </picker>
          </view>
        </view>
      </scroll-view>

      <!-- æ•°é‡å’Œæ“ä½œæŒ‰é’® -->
      <view class="room-modal-footer">
        <view class="quantity-selector">
          <text class="quantity-label">æ•°é‡ï¼š</text>
          <view class="quantity-controls">
            <view class="quantity-btn minus" bindtap="onDecreaseQuantity">-</view>
            <text class="quantity-value">{{quantity}}</text>
            <view class="quantity-btn plus" bindtap="onIncreaseQuantity">+</view>
          </view>
        </view>
        <view class="room-modal-actions">
          <view class="room-modal-btn cancel" bindtap="onCloseRoomModal">å–æ¶ˆ</view>
          <view class="room-modal-btn confirm" bindtap="onBookNow">ç¡®å®š</view>
        </view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æ“ä½œæ ï¼šå¯¼èˆª + é¢„è®¢æŒ‰é’® -->
  <view wx:if="{{detail}}" class="action-bar">
    <view class="action-nav-icons">
      <view class="nav-icon" bindtap="onGoHome">
        <text class="nav-icon-text">ğŸ </text>
        <text class="nav-icon-label">é¦–é¡µ</text>
      </view>
      <view class="nav-icon" bindtap="onGoCart">
        <text class="nav-icon-text">ğŸ›’</text>
        <text class="nav-icon-label">è´­ç‰©è½¦</text>
      </view>
    </view>
    <view class="action-buttons">
      <view class="action-btn buy" bindtap="onBookNow">
        <text class="action-btn-text">ç«‹å³é¢„è®¢</text>
      </view>
    </view>
  </view>
</view>

