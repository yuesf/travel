<!--åœ°å›¾åˆ—è¡¨é¡µ-->
<view class="page-container">
  <!-- åœ°å›¾åˆ—è¡¨ -->
  <scroll-view
    class="map-scroll"
    scroll-y
    enable-back-to-top
    refresher-enabled
    refresher-triggered="{{loading}}"
    bindrefresherrefresh="onPullDownRefresh"
  >
    <!-- åœ°å›¾å¡ç‰‡åˆ—è¡¨ -->
    <view wx:if="{{mapList.length > 0}}" class="map-list">
      <view
        wx:for="{{mapList}}"
        wx:key="id"
        id="map-{{item.id}}"
        class="map-card {{targetMapId === item.id ? 'target-map' : ''}}"
      >
        <!-- å…¬å‘Šå†…å®¹ -->
        <view wx:if="{{item.announcement}}" class="announcement-section">
          <view class="announcement-label">å…¬å‘Š</view>
          <view class="announcement-content">{{item.announcement}}</view>
        </view>

        <!-- åœ°å›¾å±•ç¤º -->
        <view class="map-section">
          <map
            longitude="{{item.longitude}}"
            latitude="{{item.latitude}}"
            scale="15"
            markers="{{item.markers}}"
            show-location="{{true}}"
            enable-zoom="{{true}}"
            enable-scroll="{{true}}"
            enable-rotate="{{false}}"
          ></map>
        </view>

        <!-- åœ°å›¾ä¿¡æ¯ -->
        <view class="map-info-section">
          <view class="map-name">{{item.name}}</view>
          <view wx:if="{{item.address}}" class="map-address">{{item.address}}</view>
          <view class="map-coordinates">
            <text>ç»åº¦: {{item.longitude}}</text>
            <text style="margin-left: 20rpx;">çº¬åº¦: {{item.latitude}}</text>
          </view>
        </view>

        <!-- å¯¼èˆªæŒ‰é’® -->
        <view class="map-actions">
          <button
            class="navigate-btn"
            type="primary"
            size="mini"
            bindtap="onNavigate"
            data-longitude="{{item.longitude}}"
            data-latitude="{{item.latitude}}"
            data-name="{{item.name}}"
            data-address="{{item.address}}"
          >
            å¯¼èˆªåˆ°è¿™é‡Œ
          </button>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view wx:else class="empty-container">
      <view class="empty-icon">ğŸ—ºï¸</view>
      <view class="empty-text">æš‚æ— åœ°å›¾ä¿¡æ¯</view>
    </view>

    <!-- åŠ è½½æç¤º -->
    <view wx:if="{{loading && mapList.length === 0}}" class="loading-container">
      <text>åŠ è½½ä¸­...</text>
    </view>
  </scroll-view>
</view>
