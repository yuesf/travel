<!--æˆ‘çš„é¡µé¢-->
<view class="page-container">
  <!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
  <custom-nav-bar title="æˆ‘çš„" id="navBar" />

  <!-- é¡µé¢å†…å®¹åŒºåŸŸ -->
  <view class="page-content" style="padding-top: {{navBarTotalHeight}}px;">
    <!-- éª¨æ¶å±ï¼šé¦–æ¬¡åŠ è½½æ—¶æ˜¾ç¤º -->
    <skeleton wx:if="{{loading && !isLoggedIn}}" type="list" loading="{{true}}" rows="{{5}}" animated="{{true}}" />

    <!-- å®é™…å†…å®¹ -->
    <view wx:if="{{!loading || isLoggedIn}}">
    <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
    <view class="user-card">
    <view wx:if="{{isLoggedIn}}" class="user-info">
      <image class="avatar" src="{{userInfo.avatar || '/assets/icons/default-avatar.png'}}" mode="aspectFill"></image>
      <view class="user-details">
        <text class="nickname">{{userInfo.nickname || 'å¾®ä¿¡ç”¨æˆ·'}}</text>
        <text class="phone" wx:if="{{userInfo.phone}}">{{userInfo.phone}}</text>
      </view>
    </view>
    <view wx:else class="login-prompt">
      <image class="avatar" src="/assets/icons/default-avatar.png" mode="aspectFill"></image>
      <view class="login-btn-wrapper">
        <button class="login-btn" bindtap="goToLogin">ç™»å½•/æ³¨å†Œ</button>
      </view>
    </view>
  </view>

  <!-- è®¢å•å…¥å£å¡ç‰‡ -->
  <view class="order-card" wx:if="{{isLoggedIn}}">
    <view class="order-item" bindtap="goToOrders" data-status="PENDING_PAY">
      <text class="order-label">å¾…æ”¯ä»˜</text>
      <view class="order-badge" wx:if="{{orderCounts.pendingPay > 0}}">
        <text class="badge-text">{{orderCounts.pendingPay}}</text>
      </view>
    </view>
    <view class="order-item" bindtap="goToOrders" data-status="PAID">
      <text class="order-label">å¾…ä½¿ç”¨</text>
      <view class="order-badge" wx:if="{{orderCounts.pendingUse > 0}}">
        <text class="badge-text">{{orderCounts.pendingUse}}</text>
      </view>
    </view>
    <view class="order-item" bindtap="goToOrders" data-status="COMPLETED">
      <text class="order-label">å·²å®Œæˆ</text>
      <view class="order-badge" wx:if="{{orderCounts.completed > 0}}">
        <text class="badge-text">{{orderCounts.completed}}</text>
      </view>
    </view>
    <view class="order-item" bindtap="goToOrders" data-status="CANCELLED">
      <text class="order-label">å·²å–æ¶ˆ</text>
      <view class="order-badge" wx:if="{{orderCounts.cancelled > 0}}">
        <text class="badge-text">{{orderCounts.cancelled}}</text>
      </view>
    </view>
  </view>

  <!-- åŠŸèƒ½å…¥å£åˆ—è¡¨ -->
  <view class="menu-list">
    <view class="menu-item" bindtap="goToOrders">
      <text class="menu-icon">ğŸ“‹</text>
      <text class="menu-label">æˆ‘çš„è®¢å•</text>
      <text class="menu-arrow">></text>
    </view>
    <!-- 
    <view class="menu-item" bindtap="goToCoupons">
      <text class="menu-icon">ğŸ«</text>
      <text class="menu-label">æˆ‘çš„ä¼˜æƒ åˆ¸</text>
      <text class="menu-arrow">></text>
    </view>
    <view class="menu-item" bindtap="goToFavorites">
      <text class="menu-icon">â¤ï¸</text>
      <text class="menu-label">æˆ‘çš„æ”¶è—</text>
      <text class="menu-arrow">></text>
    </view>
    -->
    <view class="menu-item" bindtap="goToAddress">
      <text class="menu-icon">ğŸ“</text>
      <text class="menu-label">æ”¶è´§åœ°å€</text>
      <text class="menu-arrow">></text>
    </view>
    <!--
    <view class="menu-item" bindtap="goToService">
      <text class="menu-icon">ğŸ’¬</text>
      <text class="menu-label">å®¢æœä¸­å¿ƒ</text>
      <text class="menu-arrow">></text>
    </view>
    <view class="menu-item" bindtap="goToAbout">
      <text class="menu-icon">â„¹ï¸</text>
      <text class="menu-label">å…³äºæˆ‘ä»¬</text>
      <text class="menu-arrow">></text>
    </view>
    -->
  </view>

    <!-- é€€å‡ºç™»å½•æŒ‰é’® -->
    <view class="logout-section" wx:if="{{isLoggedIn}}">
      <button class="logout-btn" bindtap="logout">é€€å‡ºç™»å½•</button>
    </view>
  </view>
  <!-- é¡µé¢å†…å®¹åŒºåŸŸç»“æŸ -->
  </view>
</view>
