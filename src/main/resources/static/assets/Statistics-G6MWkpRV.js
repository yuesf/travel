import{K as T,b as M,E as C,L as k,c as A,d as N,ae as U,g as S}from"./element-plus-BQiw23q9.js";import{r as D,a0 as B,c as _,x as P,A as F,B as e,C as s,o as O,D as r,R as v,Q as g,u as f,aW as y}from"./vue-vendor-Cs8obalv.js";import{b as R}from"./miniprogram-Bq4ZPLt3.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{X as I,Z as H,_ as K,$ as L,a0 as Q,a1 as W,a2 as X,a3 as Z}from"./vendor-x5eiJF7K.js";import"./index-DBeEaY1O.js";const j={class:"statistics-container"},q={class:"stat-item"},G={class:"stat-value"},J={class:"stat-item"},tt={class:"stat-value"},et={class:"stat-item"},at={class:"stat-value"},st={class:"stat-item"},ot={class:"stat-value"},lt={__name:"Statistics",setup(rt){I([H,K,L,Q,W,X,Z]);const x=D(!1),u=D({access:{},order:{},product:{},user:{}}),d=B({startDate:"",endDate:""}),m=async()=>{x.value=!0;try{const l={};d.startDate&&(l.startDate=d.startDate),d.endDate&&(l.endDate=d.endDate);const t=await R(l);t.data&&(u.value=t.data)}catch(l){console.error("加载统计数据失败:",l),C.error("加载统计数据失败")}finally{x.value=!1}},w=()=>{d.startDate="",d.endDate="",m()},b=l=>l?`${Number(l).toFixed(2)}%`:"0%",V=_(()=>{var o,c;const l=((o=u.value.access)==null?void 0:o.pvTrend)||[],t=((c=u.value.access)==null?void 0:c.uvTrend)||[];return{title:{text:"访问趋势",left:"center"},tooltip:{trigger:"axis"},legend:{data:["PV","UV"],bottom:0},xAxis:{type:"category",data:l.map(a=>a.date||a.day)},yAxis:{type:"value"},series:[{name:"PV",type:"line",data:l.map(a=>a.count||a.value||0)},{name:"UV",type:"line",data:t.map(a=>a.count||a.value||0)}]}}),Y=_(()=>{var o,c;const l=((o=u.value.order)==null?void 0:o.orderTrend)||[],t=((c=u.value.order)==null?void 0:c.amountTrend)||[];return{title:{text:"订单趋势",left:"center"},tooltip:{trigger:"axis",formatter:a=>{let p=`${a[0].axisValue}<br/>`;return a.forEach(i=>{i.seriesName==="订单数"?p+=`${i.marker}${i.seriesName}: ${i.value}<br/>`:p+=`${i.marker}${i.seriesName}: ¥${i.value}<br/>`}),p}},legend:{data:["订单数","订单金额"],bottom:0},xAxis:{type:"category",data:l.map(a=>a.date||a.day)},yAxis:[{type:"value",name:"订单数",position:"left"},{type:"value",name:"订单金额",position:"right"}],series:[{name:"订单数",type:"bar",data:l.map(a=>a.count||a.value||0)},{name:"订单金额",type:"line",yAxisIndex:1,data:t.map(a=>a.amount||a.value||0)}]}}),$=_(()=>{var t;const l=((t=u.value.user)==null?void 0:t.newUserTrend)||[];return{title:{text:"新增用户趋势",left:"center"},tooltip:{trigger:"axis"},xAxis:{type:"category",data:l.map(o=>o.date||o.day)},yAxis:{type:"value"},series:[{name:"新增用户",type:"line",data:l.map(o=>o.count||o.value||0)}]}});return P(()=>{m()}),(l,t)=>{const o=M,c=k,a=T,p=U,i=N,h=S,E=A;return O(),F("div",j,[e(a,{gutter:20,class:"statistics-row"},{default:s(()=>[e(c,{span:6},{default:s(()=>[e(o,{shadow:"hover",class:"stat-card"},{default:s(()=>{var n;return[r("div",q,[t[2]||(t[2]=r("div",{class:"stat-label"},"总访问量 (PV)",-1)),r("div",G,v(((n=u.value.access)==null?void 0:n.pv)||0),1)])]}),_:1})]),_:1}),e(c,{span:6},{default:s(()=>[e(o,{shadow:"hover",class:"stat-card"},{default:s(()=>{var n;return[r("div",J,[t[3]||(t[3]=r("div",{class:"stat-label"},"独立访客 (UV)",-1)),r("div",tt,v(((n=u.value.access)==null?void 0:n.uv)||0),1)])]}),_:1})]),_:1}),e(c,{span:6},{default:s(()=>[e(o,{shadow:"hover",class:"stat-card"},{default:s(()=>{var n;return[r("div",et,[t[4]||(t[4]=r("div",{class:"stat-label"},"总订单数",-1)),r("div",at,v(((n=u.value.order)==null?void 0:n.totalOrders)||0),1)])]}),_:1})]),_:1}),e(c,{span:6},{default:s(()=>[e(o,{shadow:"hover",class:"stat-card"},{default:s(()=>{var n;return[r("div",st,[t[5]||(t[5]=r("div",{class:"stat-label"},"订单转化率",-1)),r("div",ot,v(b((n=u.value.order)==null?void 0:n.conversionRate)),1)])]}),_:1})]),_:1})]),_:1}),e(o,{shadow:"never",class:"section-card"},{default:s(()=>[e(E,{inline:!0,model:d},{default:s(()=>[e(i,{label:"开始日期"},{default:s(()=>[e(p,{modelValue:d.startDate,"onUpdate:modelValue":t[0]||(t[0]=n=>d.startDate=n),type:"date",placeholder:"选择开始日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),e(i,{label:"结束日期"},{default:s(()=>[e(p,{modelValue:d.endDate,"onUpdate:modelValue":t[1]||(t[1]=n=>d.endDate=n),type:"date",placeholder:"选择结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),e(i,null,{default:s(()=>[e(h,{type:"primary",onClick:m},{default:s(()=>[...t[6]||(t[6]=[g("查询",-1)])]),_:1}),e(h,{onClick:w},{default:s(()=>[...t[7]||(t[7]=[g("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(o,{shadow:"never",class:"section-card"},{header:s(()=>[...t[8]||(t[8]=[r("div",{class:"card-header"},[r("span",null,"访问统计")],-1)])]),default:s(()=>[e(f(y),{option:V.value,style:{height:"300px",width:"100%"},autoresize:""},null,8,["option"])]),_:1}),e(o,{shadow:"never",class:"section-card"},{header:s(()=>[...t[9]||(t[9]=[r("div",{class:"card-header"},[r("span",null,"订单统计")],-1)])]),default:s(()=>[e(f(y),{option:Y.value,style:{height:"300px",width:"100%"},autoresize:""},null,8,["option"])]),_:1}),e(o,{shadow:"never",class:"section-card"},{header:s(()=>[...t[10]||(t[10]=[r("div",{class:"card-header"},[r("span",null,"用户统计")],-1)])]),default:s(()=>[e(f(y),{option:$.value,style:{height:"300px",width:"100%"},autoresize:""},null,8,["option"])]),_:1})])}}},vt=z(lt,[["__scopeId","data-v-748de60d"]]);export{vt as default};
