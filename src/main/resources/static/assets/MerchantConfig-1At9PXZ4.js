import{b as N,c as C,d as P,e as M,g as k,E as m}from"./element-plus-BQiw23q9.js";import{s as g}from"./index-DBeEaY1O.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as u,a0 as R,x as U,A as D,B as t,C as l,o as I,Q as v,R as F,D as E}from"./vue-vendor-Cs8obalv.js";import"./vendor-x5eiJF7K.js";function j(){return g({url:"/admin/merchant-config",method:"get"})}function O(i){return g({url:"/admin/merchant-config",method:"post",data:i})}function S(i){return g({url:"/admin/merchant-config",method:"put",data:i})}const q={class:"merchant-config-container"},A={__name:"MerchantConfig",setup(i){const d=u(null),f=u(!1),r=u(!1),p=u(null),e=R({merchantName:"",contactPhone:"",contactEmail:"",address:"",description:""}),V={merchantName:[{required:!0,message:"请输入商家名称",trigger:"blur"}],contactPhone:[{pattern:/^1[3-9]\d{9}$/,message:"联系电话格式不正确，请输入11位手机号",trigger:"blur"}],contactEmail:[{type:"email",message:"邮箱格式不正确",trigger:"blur"}]},h=async()=>{try{const a=await j();a.code===200&&a.data?(r.value=!0,p.value=a.data.id,Object.assign(e,{merchantName:a.data.merchantName||"",contactPhone:a.data.contactPhone||"",contactEmail:a.data.contactEmail||"",address:a.data.address||"",description:a.data.description||""})):(r.value=!1,p.value=null)}catch(a){console.error("加载配置失败:",a),r.value=!1,p.value=null}},y=async()=>{if(d.value)try{await d.value.validate(),f.value=!0;const a={merchantName:e.merchantName,contactPhone:e.contactPhone||void 0,contactEmail:e.contactEmail||void 0,address:e.address||void 0,description:e.description||void 0};r.value?(await S(a),m.success("更新配置成功")):(await O(a),m.success("创建配置成功")),await h()}catch(a){a.message?m.error(a.message):m.error(r.value?"更新配置失败":"创建配置失败")}finally{f.value=!1}},b=()=>{d.value&&d.value.resetFields(),r.value?h():Object.assign(e,{merchantName:"",contactPhone:"",contactEmail:"",address:"",description:""})};return U(()=>{h()}),(a,o)=>{const c=M,s=P,_=k,w=C,x=N;return I(),D("div",q,[t(x,{shadow:"never"},{header:l(()=>[...o[5]||(o[5]=[E("div",{class:"card-header"},[E("span",null,"商家配置")],-1)])]),default:l(()=>[t(w,{ref_key:"formRef",ref:d,model:e,rules:V,"label-width":"140px",class:"merchant-config-form"},{default:l(()=>[t(s,{label:"商家名称",prop:"merchantName"},{default:l(()=>[t(c,{modelValue:e.merchantName,"onUpdate:modelValue":o[0]||(o[0]=n=>e.merchantName=n),placeholder:"请输入商家名称",style:{width:"400px"}},null,8,["modelValue"])]),_:1}),t(s,{label:"联系电话",prop:"contactPhone"},{default:l(()=>[t(c,{modelValue:e.contactPhone,"onUpdate:modelValue":o[1]||(o[1]=n=>e.contactPhone=n),placeholder:"请输入联系电话（11位手机号）",style:{width:"400px"}},null,8,["modelValue"])]),_:1}),t(s,{label:"联系邮箱",prop:"contactEmail"},{default:l(()=>[t(c,{modelValue:e.contactEmail,"onUpdate:modelValue":o[2]||(o[2]=n=>e.contactEmail=n),placeholder:"请输入联系邮箱",style:{width:"400px"}},null,8,["modelValue"])]),_:1}),t(s,{label:"商家地址"},{default:l(()=>[t(c,{modelValue:e.address,"onUpdate:modelValue":o[3]||(o[3]=n=>e.address=n),type:"textarea",rows:2,placeholder:"请输入商家地址（可选）",style:{width:"500px"}},null,8,["modelValue"])]),_:1}),t(s,{label:"商家描述"},{default:l(()=>[t(c,{modelValue:e.description,"onUpdate:modelValue":o[4]||(o[4]=n=>e.description=n),type:"textarea",rows:4,placeholder:"请输入商家描述（可选）",style:{width:"500px"}},null,8,["modelValue"])]),_:1}),t(s,null,{default:l(()=>[t(_,{type:"primary",onClick:y,loading:f.value},{default:l(()=>[v(F(r.value?"更新配置":"创建配置"),1)]),_:1},8,["loading"]),t(_,{onClick:b},{default:l(()=>[...o[6]||(o[6]=[v("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}},H=B(A,[["__scopeId","data-v-0c2ad998"]]);export{H as default};
