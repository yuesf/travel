import{b as j,E as C,c as W,d as X,e as q,Q as G,R as H,g as J,S as Z,O as V,T as ee,U as te,V as ae,W as oe,X as le,Y as ne,o as se}from"./element-plus-BQiw23q9.js";import{a0 as z,r as B,x as re,A as E,B as t,C as o,aY as ie,o as _,ax as D,u as f,Q as r,D as g,M as de,m as ce,R as y}from"./vue-vendor-Cs8obalv.js";import{g as pe,d as ue}from"./attractions-DXGY3QSt.js";import{_ as me}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-x5eiJF7K.js";import"./index-DBeEaY1O.js";const _e={class:"attraction-list-container"},fe={class:"toolbar"},ge={class:"toolbar-left"},ye={class:"toolbar-right"},he={key:0},be={key:1},ve={class:"pagination-wrapper"},ke={__name:"AttractionList",setup(we){const h=ie(),s=z({name:"",city:"",status:null}),b=B([]),u=B(!1),n=z({page:1,pageSize:10,total:0}),d=z({prop:null,order:null}),c=async()=>{u.value=!0;try{const l={page:n.page,pageSize:n.pageSize,name:s.name||void 0,city:s.city||void 0,status:s.status};d.prop&&d.order&&(l.orderBy=d.prop,l.order=d.order==="ascending"?"asc":"desc");const e=await pe(l);e.data&&(b.value=e.data.list||[],n.total=e.data.total||0)}catch(l){console.error("加载景点列表失败:",l),C.error("加载景点列表失败"),b.value=[],n.total=0}finally{u.value=!1}},v=()=>{n.page=1,c()},T=()=>{s.name="",s.city="",s.status=null,d.prop=null,d.order=null,n.page=1,c()},$=l=>{n.page=l,c()},P=l=>{n.pageSize=l,n.page=1,c()},U=({prop:l,order:e})=>{d.prop=l,d.order=e,c()},A=()=>{h.push("/attractions/create")},L=l=>{h.push(`/attractions/${l.id}`)},I=l=>{h.push(`/attractions/edit/${l.id}`)},M=async l=>{try{await se.confirm(`确定要删除景点"${l.name}"吗？删除后状态将改为下架。`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),u.value=!0;try{await ue(l.id),C.success("删除成功"),c()}catch(e){console.error("删除景点失败:",e),C.error("删除景点失败")}finally{u.value=!1}}catch{}},N=l=>l?new Date(l).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-";return re(()=>{c()}),(l,e)=>{const S=q,m=X,k=H,R=G,p=J,F=W,w=j,i=ae,K=oe,O=te,Q=ne,Y=le;return _(),E("div",_e,[t(w,{class:"search-card",shadow:"never"},{default:o(()=>[t(F,{model:s,inline:!0,class:"search-form"},{default:o(()=>[t(m,{label:"景点名称"},{default:o(()=>[t(S,{modelValue:s.name,"onUpdate:modelValue":e[0]||(e[0]=a=>s.name=a),placeholder:"请输入景点名称",clearable:"",style:{width:"200px"},onKeyup:D(v,["enter"])},null,8,["modelValue"])]),_:1}),t(m,{label:"城市"},{default:o(()=>[t(S,{modelValue:s.city,"onUpdate:modelValue":e[1]||(e[1]=a=>s.city=a),placeholder:"请输入城市",clearable:"",style:{width:"150px"},onKeyup:D(v,["enter"])},null,8,["modelValue"])]),_:1}),t(m,{label:"状态"},{default:o(()=>[t(R,{modelValue:s.status,"onUpdate:modelValue":e[2]||(e[2]=a=>s.status=a),placeholder:"请选择状态",clearable:"",style:{width:"120px"}},{default:o(()=>[t(k,{label:"全部",value:null}),t(k,{label:"上架",value:1}),t(k,{label:"下架",value:0})]),_:1},8,["modelValue"])]),_:1}),t(m,null,{default:o(()=>[t(p,{type:"primary",onClick:v,icon:f(Z)},{default:o(()=>[...e[5]||(e[5]=[r("搜索",-1)])]),_:1},8,["icon"]),t(p,{onClick:T,icon:f(V)},{default:o(()=>[...e[6]||(e[6]=[r("重置",-1)])]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])]),_:1}),t(w,{class:"toolbar-card",shadow:"never"},{default:o(()=>[g("div",fe,[g("div",ge,[t(p,{type:"primary",onClick:A,icon:f(ee)},{default:o(()=>[...e[7]||(e[7]=[r("添加景点",-1)])]),_:1},8,["icon"])]),g("div",ye,[t(p,{icon:f(V),onClick:c},{default:o(()=>[...e[8]||(e[8]=[r("刷新",-1)])]),_:1},8,["icon"])])])]),_:1}),t(w,{class:"table-card",shadow:"never"},{default:o(()=>[de((_(),ce(O,{data:b.value,stripe:"",border:"",style:{width:"100%"},onSortChange:U},{default:o(()=>[t(i,{prop:"id",label:"ID",width:"80",sortable:"custom"}),t(i,{prop:"name",label:"景点名称","min-width":"150","show-overflow-tooltip":""}),t(i,{prop:"location",label:"位置","min-width":"120","show-overflow-tooltip":""},{default:o(({row:a})=>[r(y(`${a.city||""}${a.district||""}`),1)]),_:1}),t(i,{prop:"city",label:"城市",width:"100"}),t(i,{prop:"ticketPrice",label:"门票价格",width:"100",sortable:"custom"},{default:o(({row:a})=>[a.ticketPrice?(_(),E("span",he,"¥"+y(a.ticketPrice),1)):(_(),E("span",be,"-"))]),_:1}),t(i,{prop:"ticketStock",label:"库存",width:"100",sortable:"custom"}),t(i,{prop:"status",label:"状态",width:"100"},{default:o(({row:a})=>[t(K,{type:a.status===1?"success":"info"},{default:o(()=>[r(y(a.status===1?"上架":"下架"),1)]),_:2},1032,["type"])]),_:1}),t(i,{prop:"createTime",label:"创建时间",width:"180",sortable:"custom"},{default:o(({row:a})=>[r(y(N(a.createTime)),1)]),_:1}),t(i,{label:"操作",width:"200",fixed:"right"},{default:o(({row:a})=>[t(p,{link:"",type:"primary",size:"small",onClick:x=>L(a)},{default:o(()=>[...e[9]||(e[9]=[r("查看",-1)])]),_:1},8,["onClick"]),t(p,{link:"",type:"primary",size:"small",onClick:x=>I(a)},{default:o(()=>[...e[10]||(e[10]=[r("编辑",-1)])]),_:1},8,["onClick"]),t(p,{link:"",type:"danger",size:"small",onClick:x=>M(a),disabled:a.status===0},{default:o(()=>[...e[11]||(e[11]=[r(" 删除 ",-1)])]),_:1},8,["onClick","disabled"])]),_:1})]),_:1},8,["data"])),[[Y,u.value]]),g("div",ve,[t(Q,{"current-page":n.page,"onUpdate:currentPage":e[3]||(e[3]=a=>n.page=a),"page-size":n.pageSize,"onUpdate:pageSize":e[4]||(e[4]=a=>n.pageSize=a),"page-sizes":[10,20,50,100],total:n.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:P,onCurrentChange:$},null,8,["current-page","page-size","total"])])]),_:1})])}}},Be=me(ke,[["__scopeId","data-v-897b6d8d"]]);export{Be as default};
