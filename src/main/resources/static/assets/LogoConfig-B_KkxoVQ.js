import{b as y,c as x,d as O,g as C,E as r,o as M}from"./element-plus-BQiw23q9.js";import{I as w}from"./ImageUpload-v2Ox_fSm.js";import{a as i,u as I,c as U,d as V}from"./miniprogram-Bq4ZPLt3.js";import{_ as v}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as G,a0 as B,x as E,A as N,B as t,C as l,o as R,D as c,Q as d}from"./vue-vendor-Cs8obalv.js";import"./vendor-x5eiJF7K.js";import"./index-DBeEaY1O.js";const b={class:"logo-config-container"},P={__name:"LogoConfig",setup(h){const s=G(!1),a=B({logoUrl:""}),f=async()=>{try{const e=await i("MINIPROGRAM_LOGO");if(e.data&&e.data.configValue)try{const o=JSON.parse(e.data.configValue);a.logoUrl=o.logoUrl||""}catch(o){console.error("解析 Logo 配置失败:",o)}}catch{console.log("Logo 配置不存在，使用默认值")}},m=async()=>{if(!a.logoUrl){r.warning("请上传 Logo 图片");return}s.value=!0;try{const e=JSON.stringify({logoUrl:a.logoUrl});let o=null;try{o=(await i("MINIPROGRAM_LOGO")).data}catch{}o?await I(o.id,{configValue:e}):await U({configKey:"MINIPROGRAM_LOGO",configType:"SYSTEM",configValue:e,description:"小程序 Logo 配置",sort:0,status:1}),r.success("保存成功")}catch(e){console.error("保存 Logo 配置失败:",e),r.error("保存失败")}finally{s.value=!1}},u=async()=>{try{await M.confirm("确定要删除 Logo 配置吗？删除后将使用默认 Logo。","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});try{const e=await i("MINIPROGRAM_LOGO");e.data&&(await V(e.data.id),a.logoUrl="",r.success("删除成功"))}catch{r.info("配置不存在")}}catch{}};return E(()=>{f()}),(e,o)=>{const n=O,g=C,p=x,_=y;return R(),N("div",b,[t(_,{shadow:"never"},{header:l(()=>[...o[1]||(o[1]=[c("div",{class:"card-header"},[c("span",null,"小程序 Logo 配置")],-1)])]),default:l(()=>[t(p,{model:a,"label-width":"120px"},{default:l(()=>[t(n,{label:"Logo 图片"},{default:l(()=>[t(w,{modelValue:a.logoUrl,"onUpdate:modelValue":o[0]||(o[0]=L=>a.logoUrl=L),limit:1,"max-size":2},null,8,["modelValue"]),o[2]||(o[2]=c("div",{style:{"margin-top":"8px",color:"#909399","font-size":"12px"}}," 支持 PNG、JPG、JPEG 格式，建议尺寸 512x512 像素，最大 2MB ",-1))]),_:1}),t(n,null,{default:l(()=>[t(g,{type:"primary",onClick:m,loading:s.value},{default:l(()=>[...o[3]||(o[3]=[d(" 保存配置 ",-1)])]),_:1},8,["loading"]),t(g,{onClick:u,disabled:!a.logoUrl},{default:l(()=>[...o[4]||(o[4]=[d(" 删除 Logo（恢复默认） ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"])]),_:1})])}}},D=v(P,[["__scopeId","data-v-ac9e800b"]]);export{D as default};
